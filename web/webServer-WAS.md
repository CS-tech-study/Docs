## Web Server vs WAS

일단 둘 다 클라이언트의 HTTP 요청을 받아서 이에 알맞는 응답을 제공해주기 위해 존재

그러나 클라이언트의 HTTP 요청이 요구하는 자원의 종류에 따라 존재 이유가 나뉨
### Web Server(Apache)

클라이언트로부터 HTTP 요청을 받으면 해당 서버의 **파일 시스템에 존재하는 정적인 자원(ex. HTML,CSS, js)을 제공해주는 프로그램**

### WAS(Tomcat)

DB 조회 등 다양한 로직 처리가 요구되는 **동적인 자원을 제공하는 프로그램**
톰캣의 경우 JAVA EE 기반으로 만들어졌으며, JSP와 Servlet을 구동하기 위한 서블릿 컨테이너 역할을 수행
>JSP: HTML 코드에 JAVA 코드를 넣어 **동적 웹페이지를 생성**
>서블릿: 웹페이지를 동적으로 생성하기 위해 사용되는 자바 기반의 서버측 프로그램
>
>서블릿이 요청 데이터 패킷을 이해할 수 있도록 HttpServletRequest 객체로 변환하는 작업을 **서블릿 컨테이너에 속한 톰캣 커넥터가 수행**


## 톰캣을 아파치 톰캣이라고 부르는 이유

<img src = "https://velog.velcdn.com/images%2Fkdhyo%2Fpost%2F11fc9326-c275-42d0-8836-0992f40369bc%2F156A50404F93CDE817.png">

>출처: https://velog.io/@kdhyo/Apache-Tomcat-%EB%91%98%EC%9D%B4-%EB%AC%B4%EC%8A%A8-%EC%B0%A8%EC%9D%B4%EC%A7%80


### 헷갈리는 점

동적인 자원을 제공할 수 있으면 정적인 자원은 당연히 제공할 수 있기 때문에 WAS 자체가 Web Server의 기능을 포함할수 밖에 없음

vs

WAS의 편의를 위해 Web Server의 일부 기능을 가져와서 WAS에 임의로 포함시켰다는건지

>제 생각엔 전자일거 같은데...그래서 톰캣은 자바로 작성되어서 jvm 위에서 동작하는 거고 아파치 서버는 C언어로 작성되어서 jvm이 아닌 별도의 실행 환경에서 동작하는거고?

## 리버스 프록시

WAS 앞단에 위치하는 웹 서버를 **리버스 프록시** 라고 부름
웹 서버가 WAS 앞단에서 먼저 요청을 받아 이를 처리할 수 있는 WAS에게 넘겨주는 구조
>프론트 컨트롤러 패턴?

톰캣이 Web Server의 기능을 수행할 수 있는데
**앞단에 별도의 Web Server(리버스 프록시)를 따로 두는 이유**

1. **역할 분담**

- 웹 서버는 이미지, CSS, JavaScript와 같은 정적 콘텐츠를 효율적으로 제공하는 데 최적화되어 있는 반면, WAS는 동적인 콘텐츠를 생성하고 처리하는 데 중점
>웹 서버를 앞단에 배치하면 정적 콘텐츠는 웹 서버가 직접 처리하고, 동적 콘텐츠 요청만 WAS로 전달하여 전체적인 성능을 향상시킬 수 있다.

>식당으로 비유하자면 WAS는 요리사, 웹 서버는 서빙하는 사람(알바..?)이다.
>
>식당에 요리사(WAS)가 손님 접객을 할 수는 있다. 손님이 물(정적 자원)달라고 하면 물은 그냥 따라주면 된다.
>그러나 요리사의 본래 역할은 음식을 만드는 거고(동적인 컨텐츠 생성), 그렇게 하면 음식이 너무 늦게 나오기 때문에 요리사는 요리하는데만 집중하고, 손님 접객은 알바(웹 서버)를 고용해서 그 사람이 하도록 하는게 더 효율적이다.

2. **로드 밸런싱**
- 웹 서버가 앞단에서 클라이언트의 요청을 적절한 WAS에게 보내주어 트래픽을 분산시킬 수 있음
>알바가 양식 주문이 들어오면 양식 요리사에게, 일식 주문이 들어오면 일식 요리사에게

3. **보안 강화**
클라이언트는 리버스 프록시 서버(웹 서버)를 먼저 호출하게 되기에 실제 서버의 IP를 알 수 없음
>요리사는 주방에서 나오지 않고 안에서 요리하기 때문에 손님은 요리사가 누군지 알 수 없음
### DMZ

내부 네트워크와 외부 네트워크 사이에 위치한 중간 영역으로, **외부 네트워크 서비스를 제공**하면서 **내부 네트워크를 보호**하는 서브넷(외부에 오픈된 서버 영역)
>보통 메일 서버, 웹 서버, FTP 서버 등 외부 서비스를 제공하는 서버가 위치

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FGdtg3%2FbtrC1iDQiOD%2FRPakGslhkJo3Cgvyc6Ba70%2Fimg.png">

WAS가 해킹당할 경우 DB까지 해킹당할 수 있는 문제가 있기 때문에 WAS는 내부망에 위치시키고 리버스 프록시(웹 서버)를 DMZ 영역에 위치 

>특징은 내부망에 있는 서버는 DMZ 영역에 위치한 서버로 접근할 수 있는데 반대로 DMZ 영역에 있는 서버는 내부망에 있는 서버로 접근할 수 없음
>
>AWS의 퍼블릭 서브넷이 DMZ, 프라이빗 서브넷이 내부 네트워크라고 보면 될듯함

4. 캐싱 기능
- 자주 액세스하는 콘텐츠를 캐시하고 클라이언트에 직접 제공하여 WAS의 부하를 줄이고 응답 시간을 향상

5. **SSL(TLS) 암호화**
- SSL: 암호화 프로토콜, transport layer와 application layer 사이에 위치하여 데이터 패킷을 암호화
>HTTP 프로토콜에 SSL 프로토콜을 적용한게 HTTPS
  이러한 암호화 과정을 리버스 프록시가 대신 수행해줘서 WAS의 부담을 줄여줌
## 번외: 포워드 프록시

클라이언트 측에 위치하여 클라이언트의 요청을 대신 서버에 전달하고, 서버의 응답을 중간에서 받아서 클라이언트에게 전달

리버스 프록시와 마찬가지로 이번엔 클라이언트의 정체(IP)를 숨길 수 있음

기능:
- **익명성 제공:** 클라이언트의 실제 IP 주소를 숨겨 프라이버시를 보호
- **접근 제어:** 특정 웹사이트나 콘텐츠에 대한 접근을 제한하거나 허용
- **캐싱:** 자주 요청되는 콘텐츠를 저장하여 응답 속도를 향상

대리자로서 역할과 기능은 거의 유사하고, 위치가 클라이언트 쪽이냐 서버 쪽이냐에 따라 포워드 프록시, 리버스 프록시라고 부르는..?


<img src="https://velog.velcdn.com/images/jmjmjmz732002/post/18e032f2-10e5-4929-b01b-90a8267b9ed6/image.png">
>출처: https://velog.io/@jmjmjmz732002/Infra-Reverse-Proxy..-%EA%B3%BC%EC%97%B0-%EB%AC%B4%EC%97%87%EC%9D%BC%EA%B9%8C%EC%9A%94

## 의문점 

그럼 보통 포워드 프록시와 리버스 프록시를 둘 다 사용하나..?


## 결론

원래 본래 웹 서버의 목적은 순수 정적인 자원을 제공하기 위해 존재
그러나 이를 WAS 앞단에 두어 리버스 프록시로 사용하게 되면서 로드 밸런싱, 캐싱, SSL 암호화 같은 작업도 수행하도록 하면서 기능이 확대

>그래서 웹 서버의 역할을 **정적인 자원을 제공**하는 거에만 초점을 두면 WAS가 웹 서버를 포함한다는 설명이 맞지만, 리버스 프록시로 배치되는 웹 서버는 정적인 자원을 제공하는 기능 외에도 다른 작업을 수행하기 때문에 **이러한 기능까지 포함해서 고려한다면 틀린 설명**..이라고 생각합니다
